<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A quick mock up of a quadruped design to test Inverse Kinematics for a robot that I have built.">
  <meta name="author" content="Omar Essilfie-Quaye">
  <meta property="og:title" content="Quadruped Robot">
  <meta property="og:description" content="A quick mock up of a quadruped robot design to test Inverse Kinematics for a robot that I have built.">
  <meta property="og:image" content="https://omareq.github.io/imgs/p_019.jpg">
  <meta property="og:url" content="https://omareq.github.io/quadruped/">
  <meta property="og:site_name" content="Omar EQ Githubio">
  <link rel="stylesheet" href="../libraries/bootstrap-4.0.0/css/bootstrap.min.css">
  <script language="javascript" type="text/javascript" src="../libraries/jquery-3.3.1.min.js"></script>
  <script src="../libraries/bootstrap-4.0.0/js/bootstrap.min.js"></script>
  <script src="../libraries/chartjs-2.7.3.min.js"></script>
  <script type="text/javascript" id="MathJax-script" async src="../libraries/mathjax3-es5-tex-chtml.js"> </script>
  <link type="text/css" rel="stylesheet" href="../main.css">

  <title>Quadruped Robot</title>

</head>

<body style="width:100%; text-align:center">
  <div id="main">
    <section class="jumbotron jumbotron-main">
      <div class="container">
        <div class="row text-center">
          <h1>Quadruped Robot</h1>
        </div>
        <div class="row text-center">
          <h4><i>By Omar Essilfie-Quaye</i></h4>
        </div>
      </div>
    </section>

    <section class="container">
      <div class="row">
        <div class="col-sm-3"></div>
        <div class="col-sm-6">
  	     <div id="sketch"></div>
        </div>
        <div class="col-sm-3"></div>
      </div>
    </section>

    <section class="container" style="padding-top:10px">
      <div class="row text-center">
        <div class="col-sm-12">
          Github Repo
          <a href="https://github.com/omareq/omareq.github.io/tree/master/quadruped">
              <img src="../imgs/github-logo.png" alt="Link to github repository"
                   style="max-width:75px">
          </a>
          Docs
          <a href="./docs" rel="nofollow">
              <img src="../imgs/docs-logo.png" alt="Link to source code documentation"
                   style="max-width:75px">
          </a>
        </div>
      </div>
  </section>

    <div>
      <section class="container">
        <div class="row">
          <div class="col-sm-6">
            <canvas id="lfChart"></canvas>
          </div>
          <div class="col-sm-6">
            <canvas id="rfChart"></canvas>
          </div>
        </div>
      </section>
    </div>

    <div>
      <section class="container">
        <div class="row">
          <div class="col-sm-6">
            <canvas id="lbChart"></canvas>
          </div>
          <div class="col-sm-6">
            <canvas id="rbChart"></canvas>
          </div>
        </div>
      </section>
    </div>

    <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
          <div class="col-sm-12">
            <div>
              <h2> Walking Robots </h2>
              <p>
                Robotics in general is becoming more and more pervasive in our
                everyday lives and having robots with the ability to maintain
                pace with us effortlessly requires alternate means of
                locomotion.  In general most of the world does not have flat or
                paved land which wheeled robots can traverse easily.  The loss
                of speed and precision by sacrificing this is more than
                accounted for by the gain of the ability to navigate obstacles
                and rough or dynamic terrain provided by legged robots.
              </p>
              <p>
                Robots that can travel using means alternative to the classical
                wheeled or tracked robot paradigm provide advantages in terms of
                mobility and terrain navigation.  The general articulated limb
                approach of building these robots allows for locomotion that is
                much more versatile than wheeled robots but this comes at the
                cost of much greater complexity and increased power consumption.
                This complexity increase is not confined to the mechanical world
                but extends into the software and sensor hardware territory as
                well.  One of the main issues underpinning these complexities is
                maintaining balance.
              </p>
            </div>
          </div>
        </div>
      </section>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
          <div class="col-sm-8">
            <div>
              <!-- https://link.springer.com/chapter/10.1007/978-3-540-70534-5_11#:~:text=Walking%20robots%20are%20an%20important,world's%20land%20area%20is%20unpaved.&text=Robots%20with%20six%20or%20more,while%20three%20legs%20are%20moving. -->
              <p>
                The requirement of a walking robot to maintain balance
                immediately gives rise to a mechanical arrangement for the legs
                which has high speed and torque with a low inertia.  This means
                that as the robot falls the legs can react quickly and have
                enough control authority to correct for any wobbles.  This high
                speed motion needs to be measured by sensors with high
                acquisition rates and this in turn means that software needs to
                be able to keep up with all of this data.  One of the easiest
                ways to attempt to negate this is develop a robot with many legs
                which provide static stability if more than three are on the
                ground at any given time.
              </p>

              <p>
                A classic example of a multi legged robot is a hexapod robot.
                There are two sets of three legs so when moving one set can be on
                the ground whilst the second is in the air, this maintains
                optimal stability at all times.  Moving to the alternate extreme
                where there is almost never any stability is bipedal robots
                based on humans. These have two legs and even when both of them
                are on the ground the robot will be unstable, unless it has
                extremely wide feet.  It is very hard for a bipedal robot to
                balance when walking and it requires very agile robots with fast
                computers to achieve it.
              </p>
            </div>
          </div>
          <div class="col-sm-4">
            <div>
              <img src="./imgs/cassie-bipedal-robot-agility-robotics-single.png"  alt="Picture of a short two legged robot called cassie created by the company agility robotics" style="max-width: 85%">
              <p>
                <em>
                  <a href="https://www.agilityrobotics.com/cassie">Cassie</a>
                  Bipedal robot created by
                  <a href="https://www.agilityrobotics.com/">Agility Robotics</a>
                </em>
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

    <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
          <div class="col-sm-12">
            <div>
              <h2> Quadrupeds </h2>
              <p>
                Quadruped robots are a class of robot that have specifically 4
                legs.  This can provide great stability benefits depending on
                how the gait of the robot is implemented.  If the robot keeps 3
                legs on the ground at all times and keeps it's centre of mass
                within those 3 legs it will be statically stable at all times.
                This means it will not have to do high speed calculations to
                remain balanced.  Further discussions on gait dynamics can be
                seen further down.
              </p>

              <p>
                The quadruped robot has the fewest number of legs necessary to
                to remain statically stable during motion.  Higher numbers of
                legs are possible such as in hexapods or octopods and these come
                with other advantages and disadvantages.  Increased redundancy
                is a benefit despite the additional complexity and power draw.
                If designed right these types of robots can also have a
                significant payload mass available to provide additional
                functionality.
              </p>
            </div>
          </div>
        </div>
      </section>

      <section class="container">
        <div class="row">
            <div class="col-sm-4">
              <a id="hexapod_robot_youtube_vid" href="https://www.youtube.com/watch?v=nJdFXJ3Rnpc" >
                    <img src="./imgs/mqdefault_6s.webp" alt="Link to Hexapod Robot Video on YouTube"
                    style="max-width: 11em;">
                </a>
                <p>
                <em>
                  The Mantis hexapod robot created by
                  <a href="https://www.instagram.com/mantisrobot/">Matt Denton</a>
                </em>
              </p>
            </div>
            <div class="col-sm-4">
                <a id="spot_robot_youtube_vid" href="https://www.youtube.com/watch?v=M8YjvHYbZ9w" >
                    <img src="./imgs/spotclassic2.jpg" alt="Link to Boston Dynamics Spot Robot Video on YouTube"
                    style="max-width: 11em;">
                </a>
                <p>
                <em>
                  The Spot quadruped robot created by
                  <a href="https://www.bostondynamics.com/legacy">Boston Dynamics</a>
                </em>
              </p>
            </div>
            <div class="col-sm-4">
              <a id="robugtix_t8x_robot_youtube_vid" href="https://www.youtube.com/watch?v=-vVblGlIMgw" >
                    <img src="./imgs/robugtix-t8x-robot.jpg" alt="Link to Robugtix T8X Robot Spider video review by Adam Savage on YouTube"
                    style="max-width: 11em;">
                </a>
                <p>
                <em>
                  The T8X robot spider created by
                  <a href="https://www.robugtix.com/t8x">Robugtix</a>
                </em>
              </p>
            </div>
        </div>
    </section>

    </div>

    <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
          <div class="col-sm-12">
            <div>
              <h2> Forward Kinematics </h2>
              <p>
                <a href="https://en.wikipedia.org/wiki/Forward_kinematics">
                Forward kinematics</a> (FK) is a term used to describe the position
                of a robot's end effector given a series of join angles.  In the
                case of a quadruped robot the end effector would be the end of
                the leg.  For other robots, such as robot arms, the end effector
                could be anything from a gripper to a drill bit.
              </p>

              <p>
                In practical terms the usage of forward kinematics means that
                the control system of the robot works by controlling the joints
                of the robot without necessarily needing the end effector to
                follow a particular path to get to the goal location.  This is
                the preferred behaviour when an end effector needs to get to the
                goal location as quickly as possible.  Three animations showing
                the FK of the different servos on the quadruped robot can be
                seen below.
              </p>
            </div>
          </div>
        </div>

        <div class="row text-center">
          <div class="col-sm-4">
            <img src="./imgs/quad-FK-hip-axis-1200px.gif" alt="Gif animation of the quadruped rotating all hip yaw joints in unison" style="max-width: 11em;">
            <p><em>
              Forward Kinematics of the quadruped hip yaw servo rotation
              through 180 degrees.
            </em></p>
          </div>

          <div class="col-sm-4">
            <img src="./imgs/quad-FK-tibia-axis-1200px.gif" alt="Gif animation of the quadruped rotating all hip elevation joints in unison" style="max-width: 11em;">
            <p><em>
              Forward Kinematics of the quadruped hip elevation servo rotation
              through 180 degrees.
            </em></p>
          </div>

          <div class="col-sm-4">
            <img src="./imgs/quad-FK-knee-axis-1200px.gif" alt="Gif animation of the quadruped rotating all knee extension joints in unison" style="max-width: 11em;">
            <p><em>
              Forward Kinematics of the quadruped knee extension servo rotation
              through 180 degrees.
            </em></p>
          </div>
        </div>


        <div class="row text-left">
          <div class="col-sm-12">
            <div>
              <p>
                It should be noted that the paths that all of the legs in the
                animations above is curved.  This is because servos are rotary
                joints.  The simple usage of servos in this manner will always
                create circularly curved paths, if more complex paths are needed
                then the servos will need to be controlled in a more complex
                manner.
              </p>
            </div>
          </div>
        </div>

      </section>
    </div>

    <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
          <div class="col-sm-12">
            <div>
              <h2> Inverse Kinematics </h2>
              <p>
                If forward kinematics is calculating the position of an end
                effector given the joint positions the
                <a href="https://en.wikipedia.org/wiki/Inverse_kinematics">Inverse Kinematics (IK)
                </a>
                is the opposite.  This means that the desired location or path
                for an end effector is chosen then the appropriate joint
                positions are calculated to get there.  In this manner it is
                possible to obtain any desired path for an end effector, from
                straight lines to a helix.
                Despite the ability for IK to generate almost any desired path
                it should be noted that there are limitations.  A non exclusive
                list of these limitations include, singularities and infinite
                numbers of solutions.
              </p>

              <p>
                Whilst the end effector will be
                able to reach all locations within the working envelope they
                will not necessarily be smooth transitions between adjacent
                points.  For example travelling through the origin my make a
                motor go from 0 to 180 for a very small change in position.
                This discontinuity is known as a
                <a href="https://en.wikipedia.org/wiki/Singularity_(mathematics)">
                  singularity,
                </a> some may be removed
                through a coordinate transform and some can't be removed at all.
              </p>

              <!-- Singularity Gif  -->

              <p>
                In a simple case there will be three servos trying to manipulate
                an end effector in three dimensions: x, y and z.  In this case
                there should always be a solution to the problem however, if
                there are more actuators than dimensions to move in then there
                may be an infinite number of ways for an end effector to get to
                a desired location.
              </p>
              <p>
                For example if you have a robot arm with
                three axes and a tool which can change orientation, such as a screwdriver.  It may be possible to place the tip of the
                screwdriver on the head of a screw but you can do so from:
                directly above, from the side or any angle in-between.  In this
                case it may be beneficial to know what the end use case is so
                that the correct solution (directly above) can be selected.
                This is not always an option and there are
                <a href="https://en.wikipedia.org/wiki/Inverse_kinematics#Numerical_solutions_to_IK_problems">
                  numerical algorithms
                </a>
                that can search for a solution, this comes at the expense of
                taking longer to calculate.
              </p>

              <p>
                Quadrupeds, and all walking robots, needs IK in order to walk
                in a straight line.  The smooth motion on a leg backwards allows
                for the robot to generate a smooth walking gait without expending
                excess energy fighting friction which will occur if the motion
                is curved.  This increases the torque requirements of the motor
                and this will draw more power.  This incorrect motion may also
                reduce the ability of the robot to maintain it's balance.
              </P>
            </div>
          </div>
        </div>

        <div class="row text-center">
          <div class="col-sm-6">
            <img src="./imgs/quad-ik-horizontal-plane-diagram-v1.png" alt="" style="max-width: 20em;">
            <p><em>
              Diagram showing how to calculate the IK for a quadruped leg in the
              horizontal plane.
            </em></p>
          </div>

          <div class="col-sm-6">
            <img src="./imgs/quad-ik-vertical-plane-diagram-v1.png" alt="" style="max-width: 20em;">
            <p><em>
              Diagram showing how to calculate the IK for a quadruped leg in the
              vertical plane.
            </em></p>
          </div>
        </div>


        <div class="row text-left">
          <div class="col-sm-12">
            <p>
              Practically the goal of IK is to take a Cartesian (\(x, y, z\))
              coordinate and convert it into actuator positions.  In the case
              of the quadruped robot those actuator positions are three angles
              (\(\theta_1, \theta_2, \theta_3\)).  The diagrams showing how the
              IK for a leg can be calculated can be seen above. Using
              trigonometry it is possible to calculate (\(\theta_1,
              \theta_2, \theta_3\)) using the known lengths of the linkages
              between each joint.
            </p>

            <p>
              $$
                \theta_1 =atan(\frac{y}{x})
              $$
            </p>

            <p>
              $$r = \sqrt{x^2 + y^2} ;
              \alpha = \sqrt{(z + cx)^2 + r^2} ;
              \theta_2 = acos(\frac{\alpha^2 - fm^2 - tb^2}{-2 \times fm \times tb})$$
            </p>

            <p>
              $$\phi_1 = atan(\frac{r}{z+cx});
              \phi_2 = asin(\frac{tb \times sin(\theta_2)} {\alpha});
              \theta_3 = \pi - \phi_1 - \phi_2$$
            </p>


            <p>
              Once the IK angles have been calculated they need to be converted
              to values for the robot.  Each leg has servos that are mounted in
              different orientations.  This may require offsets or direction
              changes to fix.  All offsets in motor orientation with respect to
              the expected orientation need to be corrected through calibration
              of the motor orientation.
            </p>
            <p>
              Some of the possible paths that the legs can now take are shown in
              the animations below.  Complex combinations of these paths can
              lead to very rich movements of a quadruped robot.  The most
              obvious of which is walking.
            </p>
          </div>
        </div>

        <div class="row text-center">
          <div class="col-sm-4">
            <img src="./imgs/quad-ik-x-axis-1200.gif" alt="Gif animation of the quadruped moving it's legs in a straight line along the x axis" style="max-width: 11em;">
            <p><em>
              Inverse Kinematics of the quadruped rotating all servos in the leg
              to get a smooth motion of the leg along the x axis.
            </em></p>
          </div>

          <div class="col-sm-4">
            <img src="./imgs/quad-ik-y-axis-1200.gif" alt="Gif animation of the quadruped moving it's legs in a straight line along the y axis" style="max-width: 11em;">
            <p><em>
              Inverse Kinematics of the quadruped rotating all servos in the leg
              to get a smooth motion of the leg along the y axis.
            </em></p>
          </div>

          <div class="col-sm-4">
            <img src="./imgs/quad-ik-z-axis-1200.gif" alt="Gif animation of the quadruped moving it's legs in a straight line along the z axis" style="max-width: 11em;">
            <p><em>
              Inverse Kinematics of the quadruped rotating all servos in the leg
              to get a smooth motion of the leg along the z axis.
            </em></p>
          </div>
        </div>

      </section>
    </div>

   <!--  <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
          <div class="col-sm-12">
            <div>
              <h2> Gait Pattern </h2>
              <p>

              </p>
            </div>
          </div>
        </div>
      </section>
    </div> -->

     <!--  <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
          <div class="col-sm-12">
            <div>
              <h2> Electronics </h2>
              <p>

              </p>
            </div>
          </div>
        </div>
      </section>
    </div> -->

     <!--  <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
          <div class="col-sm-12">
            <div>
              <h2> Schematics </h2>
              <p>

              </p>
            </div>
          </div>
        </div>
      </section>
    </div> -->

     <!--  <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
          <div class="col-sm-12">
            <div>
              <h2> Assembly </h2>
              <p>

              </p>
            </div>
          </div>
        </div>
      </section> -->

      <div>
        <section class="container" style="padding-top:10px">
          <div class="row text-left">
            <div class="col-sm-12">
              <div>
                <h2> Gallery </h2>
                <p>

                </p>
              </div>
            </div>
          </div>
          <div>
          </div>
        </section>
        <section class="container" style="padding-top:10px">
          <div class="row text-center">

            <div class="col-sm-2"></div>

            <div class="col-sm-8">
              <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                  <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
                </ol>

                <div class="carousel-inner">
                  <div class="carousel-item active">
                    <img src="./imgs/quad-design-semi-finished-cad.png" alt="Quadruped Robot Semi Finished CAD rendering" class="d-block w-100">
                    <div class="carousel-caption d-none d-md-block">
                      <h5>CAD Model</h5>
                      <p>Rendering of the Quadruped CAD model</p>
                    </div>
                  </div>
                  <div class="carousel-item">
                    <img src="./imgs/quad-parts-laid-out.jpg" alt="Quadruped Robot Parts Laid out" class="d-block w-100">
                    <div class="carousel-caption d-none d-md-block">
                      <h5>Assembly</h5>
                      <p>The components needed to assemble the robot</p>
                    </div>
                  </div>
                  <div class="carousel-item">
                    <img src="./imgs/quad-sitting.jpg" alt="Robot on the floor with lights and LCD turned on" class="d-block w-100">
                    <div class="carousel-caption d-none d-md-block">
                      <h5>Electrical Test</h5>
                      <p>Power on and full electronics systems test</p>
                    </div>
                  </div>
                  <div class="carousel-item">
                    <img src="./imgs/quad-standing.jpg" alt="Robot standing up as high as it can on stretched out legs" class="d-block w-100">
                    <div class="carousel-caption d-none d-md-block">
                      <h5>Mechanical Test</h5>
                      <p>Mechanical load test for servo motors</p>
                    </div>
                  </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="sr-only">Next</span>
                </a>
              </div>
            </div>

            <div class="col-sm-2"></div>

          </div>
        </section>
      </div>

    </div>

    <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
            <div class="col-sm-12">
              <h2> See Also</h2>
            </div>
        </div>
      </section>
    </div>

    <div>
      <section class="container" style="padding-top:10px">
        <div class="row text-left">
            <div class="col-sm-4">

            <div class="project-card" id="previous">
              <h5 id="prev-title">Maze Sim 3D</h5>
              <a id="prev-url" href="../maze-sim-3d/" class="project-demo">
                <img id="prev-img" src="../imgs/p_023.jpg">
              </a>
            </div>
          </div>

          <div class="col-sm-4">
           <div class="project-card" id="previous">
            <h5 id="prev-title">Line Sim 3D</h5>
            <a id="prev-url" href="../line-sim-3d/" class="project-demo">
              <img id="prev-img" src="../imgs/p_027.jpg">
            </a>
          </div>
        </div>
      </div>
    </section>


    <section class="container">
        <div class="row">
            <div class="col-sm-4"></div>
            <div class="col-sm-4">
                <a id="external_link" href="../projects.html" >
                    <img src="../imgs/all-projects-button.jpg" alt="Link to all projects page"
                    style="max-width: 11em;">
                </a>
            </div>
            <div class="col-sm-4"></div>
        </div>
    </section>

    <section class="container">
      <div class="row">
        <div class="col-sm-3">
          <div class="project-card" id="previous">
            <h5 id="prev-title">Flood-it</h5>
            <a id="prev-url" href="../flood-it/" class="project-demo">
              <img id="prev-img" src="../imgs/p_018.jpg" onerror="this.onerror=null; this.src='../imgs/p_default.jpg'">
            </a>
          </div>
        </div>

        <div class="col-sm-6"></div>

        <div class="col-sm-3">
          <div class="project-card" id="next">
						<h5 id="next-title">Random-walk</h5>
						<a id="next-url" href="../random-walk/" class="project-demo">
							<img id="next-img" src="../imgs/p_020.jpg" onerror="this.onerror=null; this.src='../imgs/p_default.jpg'">
            </a>
          </div>
        </div>
      </div>
    </section>
  </div>

  <footer>
    <div class="links">
        <a href="https://github.com/omareq/" class="github-profile"><span>Github Profile</span></a>
        <a href="../" class="githubio"><span>Github.io Home</span></a>
        <a href="http://iamoquaye.ga/" class="iamoquaye"><span>iamoquaye</span></a>
    </div>
  </footer>

  <script language="javascript" type="text/javascript" src="../libraries/p5.js"></script>
  <script language="javascript" type="text/javascript" src="../libraries/p5.dom.js"></script>
  <script language="javascript" type="text/javascript" src="sketch.js"></script>
  <script language="javascript" type="text/javascript" src="robot.js"></script>
</body>
</html>